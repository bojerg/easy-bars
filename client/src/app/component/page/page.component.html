<div id="page-container">
  <div id="page-header-div">
    <button id="page-close" mat-raised-button color="primary" (click)="this.dialogRef.close()">X</button>
    <div>
      <input type="text" name="page-title" id="page-title" placeholder="{{placeholderTitle}}" (change)="saveTitle(title.value)" (click)="placeholderTitle = ''" (blur)="placeholderTitle = page.title" #title>
    </div>   
  </div>
  <button (click)="splitLyricsByWord()">Split by Word</button>
  <div id="lyric-cards-container">
  @for (phrase of page.lyrics; track $index) {
    @if($first) { {{resetBeatCount()}} }
    <mat-card class="phrase-card" (click)="this.activePhrase.index = $index; this.activePhrase.mode = ''">
      @if(this.activePhrase.index === $index) {
        @if(this.activePhrase.mode === 'content') {
          <input type="text" name="phrase-input" class="phrase-input" value="{{ phrase.content }}" (keydown.enter)="saveAndCloseContentEditor(active.value, $index, false)" (blur)="saveAndCloseContentEditor(active.value, $index, true)" #active>
        }
        @else {
          <mat-card-content class="phrase-input">{{ phrase.content }}</mat-card-content>
        }
      } 
      @else {
        <mat-card-title>{{ phrase.content }}</mat-card-title>
      }
      @if(this.activePhrase.index == $index) {
        <mat-card-actions class="phrase-card-actions">
          <button mat-button (click)="this.activePhrase.mode = 'content'"><mat-icon>create</mat-icon></button>
          <button mat-button><mat-icon>menu</mat-icon></button>
        </mat-card-actions>
      }
    </mat-card>
    @if (isNextBar(phrase.duration)) { 
      <div class="break"></div> 
    }  
  } @empty {
    <p style="text-align: center;">No lyrics to edit</p>
  }
    <mat-card>
      <mat-card-title><button>Add new</button></mat-card-title>
    </mat-card>
  </div>
</div>